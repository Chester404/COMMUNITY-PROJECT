{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Head from \"next/head\";\nimport Layout from \"../../components/Layout\";\nimport Link from \"next/link\";\nimport emailValidation from \"../../utils/emailValidation\";\nimport phoneValidation from \"../../utils/phoneValidation\";\nimport axios from \"axios\";\nimport { useState } from \"react\";\n\nvar Signup = function Signup() {\n  var data;\n\n  var _useState = useState(false),\n      validated = _useState[0],\n      setValidated = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      email = _useState2[0],\n      setEmail = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      phoneNumber = _useState3[0],\n      setPhoneNumber = _useState3[1];\n\n  var _useState4 = useState(\"invalid\"),\n      emailValidity = _useState4[0],\n      setEmailValidity = _useState4[1];\n\n  var _useState5 = useState(\"invalid\"),\n      phoneValidity = _useState5[0],\n      setPhoneValidity = _useState5[1];\n\n  var _useState6 = useState(\"\"),\n      password = _useState6[0],\n      setPassword = _useState6[1];\n\n  var _useState7 = useState(\"mismatch\"),\n      confirmPassword = _useState7[0],\n      setConfirmPassword = _useState7[1];\n\n  var _useState8 = useState(\"invalid\"),\n      passwordFieldValidity = _useState8[0],\n      setPasswordFieldValidity = _useState8[1];\n\n  var _useState9 = useState(\"Organization\"),\n      userType = _useState9[0],\n      setUserType = _useState9[1];\n\n  var _useState10 = useState(false),\n      isSent = _useState10[0],\n      setIsSent = _useState10[1];\n\n  var _useState11 = useState(false),\n      passwordShown = _useState11[0],\n      setPasswordShown = _useState11[1];\n\n  var _useState12 = useState(false),\n      show = _useState12[0],\n      setShow = _useState12[1];\n\n  var _useState13 = useState(\"\"),\n      userName = _useState13[0],\n      setUserName = _useState13[1];\n\n  var _useState14 = useState(\"\"),\n      firstName = _useState14[0],\n      setFirstName = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      lastName = _useState15[0],\n      setLastName = _useState15[1]; // const [loading, setLoading] = useState(false);\n  // const [promptBody, setPromptBody] = useState(\"\");\n  // const [linkTo, setLinkTo] = useState(null);\n  // const [linkText, setLinkText] = useState(null);\n\n\n  var _useState16 = useState(\"blue\"),\n      statusColor = _useState16[0],\n      setStatusColor = _useState16[1];\n\n  var _useState17 = useState(\"\"),\n      status = _useState17[0],\n      setStatus = _useState17[1];\n\n  var handleShow = function handleShow() {\n    return setShow(true);\n  };\n\n  var handleClose = function handleClose() {\n    return setShow(false);\n  }; // Toggle Password Visibility\n\n\n  var togglePasswordVisiblity = function togglePasswordVisiblity() {\n    setPasswordShown(passwordShown ? false : true);\n  };\n\n  var loader = function loader() {\n    return __jsx(\"span\", {\n      className: \"spinner-border spinner-border-sm\",\n      role: \"status\",\n      \"aria-hidden\": \"true\",\n      style: {\n        width: \"1.5rem\",\n        height: \"1.5rem\"\n      }\n    });\n  }; // Email Phone Validation\n\n\n  var validateEmail = function validateEmail(e) {\n    if (emailValidation(e.target.value)) {\n      setEmail(e.target.value);\n      setEmailValidity(\"valid\");\n    } else {\n      setEmailValidity(\"invalid\");\n    }\n  };\n\n  var validatePhone = function validatePhone(e) {\n    if (phoneValidation(e.target.value)) {\n      setPhoneNumber(e.target.value);\n      setPhoneValidity(\"valid\");\n    } else {\n      setPhoneValidity(\"invalid\");\n    }\n  }; // Password Validation\n\n\n  var validatePassword = function validatePassword(e) {\n    if (e.target.value.match(/[a-z]/g) && e.target.value.match(/[A-Z]/g) && e.target.value.match(/[0-9]/g) && e.target.value.match(/[^a-zA-Z\\d]/g) && e.target.value.length >= 8) {\n      // res = \"TRUE\";\n      setPassword(e.target.value);\n      setPasswordFieldValidity(\"valid\");\n    } // return true\n    // set field to invalid\n    else {\n        // console.log(\"invalid password\")\n        setPasswordFieldValidity(\"invalid\");\n      }\n  };\n\n  var confirmPasswordMatch = function confirmPasswordMatch(e) {\n    if (e.target.value === password) {\n      setConfirmPassword(\"match\"); // data.first_name = firstName\n      // data.last_name = lastName\n      // data.email = email\n      // data.password = password\n      // data.phone_number = phoneNumber\n      // data.user_type = userType\n    } else {\n      setConfirmPassword(\"mismatch\");\n    }\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault(); //   setLoading(true);\n              // const form = event.currentTarget;\n              // if (form.checkValidity() === false) {\n              //   event.stopPropagation();\n              // }\n\n              if (!(email && password === confirmPassword)) {\n                _context.next = 17;\n                break;\n              }\n\n              setStatusColor(\"blue\");\n              setStatus(\"Please wait...\");\n              _context.prev = 4;\n              _context.next = 7;\n              return axios.post(\"http://51.116.114.155:8080/auth/registration/\", {\n                email: email,\n                password: password,\n                first_name: firstName,\n                last_name: lastName,\n                phone_number: phoneNumber\n              });\n\n            case 7:\n              result = _context.sent;\n\n              if (result) {\n                // setLoading(false);\n                console.log(\"RESULT:\", result);\n\n                if (result.status === 200 || result.statusText === \"Created\") {\n                  // go to landing page\n                  setStatusColor(\"blue\");\n                  setStatus(\"A confirmation has been sent to your email. Please retrieve the code and confirm acount\"); //   setPromptBody(\n                  //     \"A confirmation has been sent to your email. Please retrieve the code and confirm acount\"\n                  //   );\n                  //   setLinkTo(\"confirmaccount\");\n                  //   setLinkText(\"Confirm Account\");\n                  //   setShow(true);\n                  //   setLoading(false);\n                }\n              }\n\n              _context.next = 15;\n              break;\n\n            case 11:\n              _context.prev = 11;\n              _context.t0 = _context[\"catch\"](4);\n              console.log(_context.t0.message);\n\n              if (_context.t0.message === \"Request failed with status code 400\") {\n                // setPromptBody(\"User with this email already exists\");\n                // setLinkText(null);\n                // setLinkTo(null);\n                // setShow(true);\n                // setLoading(false);\n                setStatusColor(\"red\");\n                setStatus(\"User with this email already exists\");\n              } else if (_context.t0.message === \"Request failed with status code 404\") {\n                // bad endpoint\n                setStatusColor(\"red\");\n                setStatus(\"An error occured\");\n              } else if (_context.t0.message === \"Network Error\") {\n                setStatusColor(\"red\");\n                setStatus(\"Please check your network connection and try again.\"); // bad network connection\n                // setPromptBody(\n                //   \"Please check your network connection and try again.\"\n                // );\n                // setShow(true);\n                // setLoading(false);\n              }\n\n            case 15:\n              _context.next = 19;\n              break;\n\n            case 17:\n              setStatusColor(\"red\");\n              setStatus(\"Password mismatch\");\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[4, 11]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Layout, null, __jsx(Head, null, __jsx(\"link\", {\n    rel: \"stylesheet\",\n    type: \"text/css\",\n    href: \"/auth.css\"\n  })), __jsx(\"div\", {\n    style: {\n      textAlign: \"center\"\n    }\n  }, __jsx(\"div\", null, __jsx(\"img\", {\n    src: \"/images/Logo.png\"\n  })), __jsx(\"div\", null, __jsx(\"b\", null, \"Make the most out of your business\")), __jsx(\"div\", null, \"Already on Market Circle?\", \" \", __jsx(Link, {\n    href: \"/auth/login\"\n  }, __jsx(\"a\", null, __jsx(\"b\", null, \"Log in\"))))), \" \", __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"form\", {\n    style: {\n      width: \"100%\"\n    },\n    onSubmit: handleSubmit\n  }, __jsx(\"div\", {\n    className: \"form-group col-12\"\n  }, __jsx(\"label\", {\n    htmlFor: \"email\"\n  }, \"Email address / Phone\"), __jsx(\"input\", {\n    type: \"email\",\n    className: \"form-control cinput\",\n    id: \"email\",\n    \"aria-describedby\": \"emailHelp\",\n    placeholder: \"Enter email\",\n    value: email,\n    onChange: function onChange(e) {\n      return setEmail(e.target.value);\n    }\n  })), __jsx(\"div\", {\n    className: \"form-group col-12\"\n  }, __jsx(\"label\", {\n    htmlFor: \"password\"\n  }, \"Password\"), __jsx(\"input\", {\n    type: \"password\",\n    className: \"form-control cinput\",\n    id: \"password\",\n    placeholder: \"Password\",\n    \"data-toggle\": \"password\",\n    value: password,\n    onChange: function onChange(e) {\n      return setPassword(e.target.value);\n    }\n  })), __jsx(\"div\", {\n    className: \"form-group col-12\"\n  }, __jsx(\"label\", {\n    htmlFor: \"confirm_password\"\n  }, \"Confirm Password\"), __jsx(\"input\", {\n    type: \"password\",\n    className: \"form-control cinput\",\n    id: \"confirm_password\",\n    placeholder: \"Password\",\n    \"data-toggle\": \"password\",\n    value: confirmPassword,\n    onChange: function onChange(e) {\n      return setConfirmPassword(e.target.value);\n    }\n  })), __jsx(\"div\", {\n    className: \"form-group col-12\"\n  }, __jsx(\"input\", {\n    type: \"radio\",\n    id: \"organization\",\n    name: \"account_type\",\n    value: \"organization\"\n  }), \" \", __jsx(\"label\", {\n    htmlFor: \"organization\"\n  }, \"Organization\"), \" \", __jsx(\"input\", {\n    type: \"radio\",\n    id: \"individual\",\n    name: \"account_type\",\n    value: \"individual\"\n  }), \" \", __jsx(\"label\", {\n    htmlFor: \"individual\"\n  }, \"Individual\")), __jsx(\"div\", {\n    className: \"form-group col-12\"\n  }, __jsx(\"button\", {\n    type: \"submit\",\n    className: \"btn btn-primary btn-block submitbutton\"\n  }, \"Sign Up\")), __jsx(\"div\", {\n    style: {\n      textAlign: \"center\",\n      color: statusColor\n    }\n  }, \"\\xA0\", status), __jsx(\"div\", {\n    style: {\n      textAlign: \"center\"\n    }\n  }, \"By clicking Sing up, you agree to the Market Circle\", __jsx(\"br\", null), __jsx(\"b\", null, __jsx(\"a\", {\n    href: \"\"\n  }, \"User Agreement,\"), __jsx(\"a\", {\n    href: \"\"\n  }, \"Privacy Policy\")), \" \", \"and\", \" \", __jsx(\"b\", null, __jsx(\"a\", {\n    href: \"\"\n  }, \"Cookie Policy\"))))));\n};\n\nexport default Signup;","map":null,"metadata":{},"sourceType":"module"}