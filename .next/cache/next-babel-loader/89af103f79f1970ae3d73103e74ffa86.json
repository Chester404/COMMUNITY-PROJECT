{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Head from \"next/head\";\nimport Layout from \"../../components/Layout\";\nimport Link from \"next/link\";\nimport Form from \"react-bootstrap/Form\"; // import Button from \"react-bootstrap/Button\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faEye } from \"@fortawesome/free-solid-svg-icons\";\n\nvar eye = __jsx(FontAwesomeIcon, {\n  icon: faEye\n}); // import styles from \"./styles.module.css\";\n\n\nimport emailValidation from \"../../utils/emailValidation\";\nimport axios from \"axios\";\nimport { useState } from \"react\";\nimport Prompt from \"../../components/Prompt\";\n\nvar Signup = function Signup() {\n  var data;\n\n  var _useState = useState(false),\n      validated = _useState[0],\n      setValidated = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      email = _useState2[0],\n      setEmail = _useState2[1]; // const [phoneNumber, setPhoneNumber] = useState(\"\");\n\n\n  var _useState3 = useState(\"invalid\"),\n      emailValidity = _useState3[0],\n      setEmailValidity = _useState3[1]; // const [phoneValidity, setPhoneValidity] = useState(\"invalid\");\n\n\n  var _useState4 = useState(\"\"),\n      password = _useState4[0],\n      setPassword = _useState4[1];\n\n  var _useState5 = useState(\"mismatch\"),\n      confirmPassword = _useState5[0],\n      setConfirmPassword = _useState5[1];\n\n  var _useState6 = useState(\"invalid\"),\n      passwordFieldValidity = _useState6[0],\n      setPasswordFieldValidity = _useState6[1];\n\n  var _useState7 = useState(\"Individual\"),\n      userType = _useState7[0],\n      setUserType = _useState7[1];\n\n  var _useState8 = useState(false),\n      isSent = _useState8[0],\n      setIsSent = _useState8[1];\n\n  var _useState9 = useState(false),\n      passwordShown = _useState9[0],\n      setPasswordShown = _useState9[1];\n\n  var _useState10 = useState(false),\n      show = _useState10[0],\n      setShow = _useState10[1]; // const [userName, setUserName] = useState(\"\");\n  // const [firstName, setFirstName] = useState(\"\");\n  // const [lastName, setLastName] = useState(\"\");\n\n\n  var _useState11 = useState(false),\n      loading = _useState11[0],\n      setLoading = _useState11[1];\n\n  var _useState12 = useState(\"\"),\n      promptBody = _useState12[0],\n      setPromptBody = _useState12[1];\n\n  var _useState13 = useState(null),\n      linkTo = _useState13[0],\n      setLinkTo = _useState13[1];\n\n  var _useState14 = useState(null),\n      linkText = _useState14[0],\n      setLinkText = _useState14[1];\n\n  var _useState15 = useState(\"\"),\n      promptTitle = _useState15[0],\n      setPromptTitle = _useState15[1];\n\n  var _useState16 = useState(false),\n      is_organization = _useState16[0],\n      setIsOrganization = _useState16[1];\n\n  var handleShow = function handleShow() {\n    return setShow(true);\n  };\n\n  var handleClose = function handleClose() {\n    return setShow(false);\n  }; // Toggle Password Visibility\n\n\n  var togglePasswordVisiblity = function togglePasswordVisiblity() {\n    setPasswordShown(passwordShown ? false : true);\n  };\n\n  var loader = function loader() {\n    return __jsx(\"span\", {\n      className: \"spinner-border spinner-border-sm\",\n      role: \"status\",\n      \"aria-hidden\": \"true\",\n      style: {\n        width: \"1.5rem\",\n        height: \"1.5rem\"\n      }\n    });\n  }; // Email Phone Validation\n\n\n  var validateEmail = function validateEmail(e) {\n    if (emailValidation(e.target.value)) {\n      setEmail(e.target.value);\n      setEmailValidity(\"valid\");\n    } else {\n      setEmailValidity(\"invalid\");\n    }\n  }; // const validatePhone = (e) => {\n  //   if (phoneValidation(e.target.value)) {\n  //     setPhoneNumber(e.target.value);\n  //     setPhoneValidity(\"valid\");\n  //   } else {\n  //     setPhoneValidity(\"invalid\");\n  //   }\n  // };\n  // Password Validation\n\n\n  var validatePassword = function validatePassword(e) {\n    console.log(confirmPassword, password);\n\n    if (e.target.value.match(/[a-z]/g) && e.target.value.match(/[A-Z]/g) && e.target.value.match(/[0-9]/g) && e.target.value.match(/[^a-zA-Z\\d]/g) && e.target.value.length >= 8) {\n      // res = \"TRUE\";\n      setPassword(e.target.value);\n      setPasswordFieldValidity(\"valid\");\n    } else {\n      // console.log(\"invalid password\")\n      setPasswordFieldValidity(\"invalid\");\n    }\n  };\n\n  var confirmPasswordMatch = function confirmPasswordMatch(e) {\n    if (e.target.value === password) {\n      setConfirmPassword(\"match\"); // data.first_name = firstName\n      // data.last_name = lastName\n      // data.email = email\n      // data.password = password\n      // data.phone_number = phoneNumber\n      // data.user_type = userType\n    } else {\n      setConfirmPassword(\"mismatch\");\n    }\n  };\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var form, result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              form = event.currentTarget;\n\n              if (!(form.checkValidity() === false)) {\n                _context.next = 8;\n                break;\n              }\n\n              setPromptTitle(\"Error\");\n              setShow(true);\n              setPromptBody(\"Invalid data input.\");\n              event.stopPropagation();\n              return _context.abrupt(\"return\");\n\n            case 8:\n              console.log(\"Here\");\n\n              if (!(email && password && confirmPassword === \"match\")) {\n                _context.next = 24;\n                break;\n              }\n\n              setLoading(true);\n              _context.prev = 11;\n              _context.next = 14;\n              return axios.post(\"http://51.116.114.155:8080/auth/registration/\", {\n                email: email,\n                password: password,\n                is_organization: is_organization\n              });\n\n            case 14:\n              result = _context.sent;\n\n              if (result) {\n                setLoading(false);\n                console.log(\"RESULT:\", result);\n\n                if (result.status === 200 || result.statusText === \"Created\") {\n                  // go to landing page\n                  setPromptBody(\"A confirmation has been sent to your email. Please retrieve the code and confirm acount\");\n                  setLinkTo(\"confirmaccount\");\n                  setLinkText(\"Confirm Account\");\n                  setShow(true);\n                  setLoading(false);\n                }\n              }\n\n              _context.next = 22;\n              break;\n\n            case 18:\n              _context.prev = 18;\n              _context.t0 = _context[\"catch\"](11);\n              console.log(_context.t0.message);\n\n              if (_context.t0.message === \"Request failed with status code 400\") {\n                setPromptBody(\"User with this email already exists\");\n                setLinkText(null);\n                setLinkTo(null);\n                setShow(true);\n                setLoading(false);\n              } else if (_context.t0.message === \"Request failed with status code 404\") {// bad endpoint\n              } else if (_context.t0.message === \"Network Error\") {\n                // bad network connection\n                setPromptBody(\"Please check your network connection and try again.\");\n                setShow(true);\n                setLoading(false);\n              }\n\n            case 22:\n              _context.next = 27;\n              break;\n\n            case 24:\n              setPromptTitle(\"Password\");\n              setShow(true);\n              setPromptBody(\"Invalid data input. Passwords mismatch\");\n\n            case 27:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[11, 18]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(Layout, null, __jsx(Head, null, __jsx(\"link\", {\n    rel: \"stylesheet\",\n    type: \"text/css\",\n    href: \"/auth.css\"\n  })), __jsx(Prompt // body={`A confirmation has been sent to your email. Please retrieve the code and\n  // confirm acount`}\n  , {\n    title: promptTitle,\n    linkTo: linkTo,\n    linkText: linkText,\n    show: show,\n    handleClose: handleClose\n  }, __jsx(\"p\", null, promptBody)), __jsx(\"div\", {\n    style: {\n      textAlign: \"center\"\n    }\n  }, __jsx(\"div\", null, __jsx(\"img\", {\n    src: \"/images/Logo.png\"\n  })), __jsx(\"div\", null, __jsx(\"b\", null, \"Make the most out of your business\")), __jsx(\"div\", null, \"Already on Market Circle?\", \" \", __jsx(Link, {\n    href: \"/auth/login\"\n  }, __jsx(\"a\", null, __jsx(\"b\", null, \"Log in\"))))), \" \", __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(Form, {\n    noValidate: true,\n    validated: validated,\n    onSubmit: handleSubmit,\n    style: {\n      width: \"100%\",\n      padding: 40\n    }\n  }, __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Email\"), __jsx(\"input\", {\n    type: \"text\",\n    id: \"signup_email\",\n    className: \"form-control\",\n    placeholder: \"Please enter a valid email..\",\n    required: true,\n    defaultValue: email,\n    onChange: validateEmail\n  }), __jsx(\"small\", {\n    id: \"emailHelp\",\n    className: \"form-text text-muted\"\n  }, emailValidity), __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, \"Please enter valid email.\")), __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Password\"), __jsx(\"input\", {\n    className: \"form-control\",\n    id: \"signup_password\",\n    type: passwordShown ? \"text\" : \"password\",\n    placeholder: \"Password must be atleast 8 characters long.\",\n    required: true,\n    defaultValue: password,\n    onChange: validatePassword\n  }), __jsx(\"i\", {\n    onClick: togglePasswordVisiblity\n  }, eye), __jsx(\"small\", {\n    id: \"emailHelp\",\n    className: \"form-text text-muted\"\n  }, passwordFieldValidity)), __jsx(\"div\", {\n    className: \"form-group\"\n  }, __jsx(\"label\", null, \"Confirm Password\"), __jsx(\"input\", {\n    id: \"signup_confirm_password\",\n    className: \"form-control\",\n    type: \"password\",\n    placeholder: \"Password must be atleast 8 characters long.\",\n    required: true // defaultValue={confirmPassword}\n    ,\n    onChange: confirmPasswordMatch\n  }), __jsx(\"small\", {\n    id: \"emailHelp\",\n    className: \"form-text text-muted\"\n  }, confirmPassword)), __jsx(\"div\", {\n    className: \"mb-3 text-center\"\n  }, __jsx(\"div\", {\n    className: \"form-check form-check-inline\"\n  }, __jsx(\"input\", {\n    className: \"form-check-input\",\n    type: \"radio\",\n    id: \"inline-radio-1\",\n    name: \"radioButton\" // checked={userType === \"Organization\"}\n    ,\n    value: \"Organization\",\n    onChange: function onChange(e) {\n      return setUserType(e.target.value);\n    }\n  }), __jsx(\"label\", {\n    className: \"form-check-label\",\n    htmlFor: \"inline-radio-1\"\n  }, \"Organization\")), __jsx(\"div\", {\n    className: \"form-check form-check-inline\"\n  }, __jsx(\"input\", {\n    className: \"form-check-input\",\n    type: \"radio\",\n    id: \"inline-radio-2\",\n    name: \"radioButton\",\n    checked: userType === \"Individual\",\n    value: \"Individual\",\n    onChange: function onChange(e) {\n      return setUserType(e.target.value);\n    }\n  }), __jsx(\"label\", {\n    className: \"form-check-label\",\n    htmlFor: \"inline-radio-2\"\n  }, \"Individual\"))), __jsx(\"button\", {\n    id: \"signup_button\",\n    className: \"btn btn-primary btn-lg btn-block\",\n    type: \"submit\"\n  }, loading ? loader() : null, \"Signup\"))));\n};\n\nexport default Signup;","map":null,"metadata":{},"sourceType":"module"}